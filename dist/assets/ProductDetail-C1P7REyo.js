import{j as e,m as t,V as se,A as V,N as te,a as re,P as le,a2 as ie,C as ne,d as oe,q as ce,a3 as K,a4 as de,a5 as me,a6 as xe,R as he,X as ge,n as _}from"./ui-B2_iPpHp.js";import{r as i,L as ue}from"./vendor-x2D2W7aw.js";import{u as pe,a as be,d as f}from"./index-DjKn7zoY.js";import{c as A,q as M,f as B,b as Z,h as O,r as ye,s as fe}from"./firebase-DlhFiCg4.js";function Q({title:s,children:c,isOpen:d,onClick:n}){return e.jsxs("div",{className:"border-b",children:[e.jsxs("button",{onClick:n,className:"flex justify-between items-center w-full py-4 text-left font-semibold",children:[e.jsx("span",{children:s}),e.jsx(t.div,{animate:{rotate:d?180:0},transition:{duration:.3},children:e.jsx(se,{className:"w-5 h-5"})})]}),e.jsx(V,{children:d&&e.jsx(t.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3},className:"overflow-hidden",children:e.jsx("div",{className:"pb-4 text-gray-600",children:c})})})]})}const T=({rating:s,size:c="w-5 h-5"})=>e.jsx("div",{className:"flex items-center",children:[...Array(5)].map((d,n)=>e.jsx(_,{className:`${c} transition-colors ${n<Math.round(s)?"fill-yellow-400 text-yellow-400":"text-gray-300"}`},n))}),je=({rating:s,setRating:c})=>{const[d,n]=i.useState(0);return e.jsx("div",{className:"flex items-center gap-1",children:[...Array(5)].map((h,x)=>{const l=x+1;return e.jsx(t.button,{type:"button",whileHover:{scale:1.2},whileTap:{scale:.9},className:"transition-all duration-150",onClick:()=>c(l),onMouseEnter:()=>n(l),onMouseLeave:()=>n(0),children:e.jsx(_,{className:`w-7 h-7 transition-colors ${l<=(d||s)?"fill-yellow-400 text-yellow-400":"text-gray-300"}`})},l)})})},we=({product:s,isLiked:c,onToggleLike:d})=>{const[n,h]=i.useState(!1),[x,l]=i.useState(0),a=[s.image,s.image,s.image],N=()=>{l(o=>(o+1)%a.length)},y=()=>{l(o=>(o-1+a.length)%a.length)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"sticky top-28",children:[e.jsxs(t.div,{className:"relative rounded-2xl overflow-hidden shadow-2xl bg-white group",whileHover:{scale:1.02},transition:{type:"spring",stiffness:300,damping:30},children:[e.jsxs("div",{className:"relative aspect-square bg-gradient-to-br from-gray-50 to-gray-100",children:[e.jsx(t.img,{src:a[x],alt:s.name,className:"w-full h-full object-cover cursor-zoom-in",initial:{opacity:0},animate:{opacity:1},onClick:()=>h(!0)},x),a.length>1&&e.jsxs(e.Fragment,{children:[e.jsx(t.button,{onClick:y,className:"absolute left-4 top-1/2 transform -translate-y-1/2 p-2 bg-white/80 backdrop-blur-sm rounded-full shadow-lg opacity-0 group-hover:opacity-100 transition-opacity",whileHover:{scale:1.1},whileTap:{scale:.9},children:e.jsx(ne,{className:"w-5 h-5 text-gray-700"})}),e.jsx(t.button,{onClick:N,className:"absolute right-4 top-1/2 transform -translate-y-1/2 p-2 bg-white/80 backdrop-blur-sm rounded-full shadow-lg opacity-0 group-hover:opacity-100 transition-opacity",whileHover:{scale:1.1},whileTap:{scale:.9},children:e.jsx(oe,{className:"w-5 h-5 text-gray-700"})})]}),e.jsxs("div",{className:"absolute top-4 right-4 flex flex-col gap-2",children:[e.jsx(t.button,{onClick:o=>{o.stopPropagation(),d(s.id)},whileHover:{scale:1.1},whileTap:{scale:.95},className:"p-3 bg-white/90 backdrop-blur-sm rounded-full shadow-lg hover:bg-white transition-all","aria-label":"Favorilere ekle",children:e.jsx(ce,{className:`w-6 h-6 transition-all duration-300 ${c?"fill-red-500 text-red-500 scale-110":"text-gray-600 hover:text-red-400"}`})}),e.jsx(t.button,{onClick:()=>h(!0),whileHover:{scale:1.1},whileTap:{scale:.95},className:"p-3 bg-white/90 backdrop-blur-sm rounded-full shadow-lg hover:bg-white transition-all","aria-label":"Yakından incele",children:e.jsx(K,{className:"w-6 h-6 text-gray-600 hover:text-blue-600"})}),e.jsx(t.button,{whileHover:{scale:1.1},whileTap:{scale:.95},className:"p-3 bg-white/90 backdrop-blur-sm rounded-full shadow-lg hover:bg-white transition-all","aria-label":"Paylaş",children:e.jsx(de,{className:"w-6 h-6 text-gray-600 hover:text-green-600"})})]}),e.jsx("div",{className:"absolute bottom-4 right-4 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-black/70 text-white text-sm rounded-full backdrop-blur-sm",children:[e.jsx(K,{className:"w-4 h-4"}),e.jsx("span",{children:"Yakından İncele"})]})})]}),a.length>1&&e.jsx("div",{className:"p-4 bg-white border-t",children:e.jsx("div",{className:"flex gap-2 justify-center",children:a.map((o,u)=>e.jsx(t.button,{onClick:()=>l(u),className:`w-16 h-16 rounded-lg overflow-hidden border-2 transition-all ${u===x?"border-blue-500":"border-gray-200"}`,whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsx("img",{src:o,alt:`${s.name} ${u+1}`,className:"w-full h-full object-cover"})},u))})})]}),e.jsxs(t.div,{className:"mt-6 grid grid-cols-3 gap-4 text-center",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:[e.jsxs("div",{className:"flex flex-col items-center gap-2 p-3 bg-white rounded-xl shadow-sm border border-gray-100",children:[e.jsx(me,{className:"w-8 h-8 text-green-500"}),e.jsx("span",{className:"text-xs font-medium text-gray-700",children:"Güvenli Ödeme"})]}),e.jsxs("div",{className:"flex flex-col items-center gap-2 p-3 bg-white rounded-xl shadow-sm border border-gray-100",children:[e.jsx(xe,{className:"w-8 h-8 text-blue-500"}),e.jsx("span",{className:"text-xs font-medium text-gray-700",children:"Hızlı Kargo"})]}),e.jsxs("div",{className:"flex flex-col items-center gap-2 p-3 bg-white rounded-xl shadow-sm border border-gray-100",children:[e.jsx(he,{className:"w-8 h-8 text-orange-500"}),e.jsx("span",{className:"text-xs font-medium text-gray-700",children:"Kolay İade"})]})]})]}),e.jsx(V,{children:n&&e.jsx(t.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/90 z-50 flex items-center justify-center p-4",onClick:()=>h(!1),children:e.jsxs(t.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},className:"relative max-w-4xl max-h-full",onClick:o=>o.stopPropagation(),children:[e.jsx("img",{src:a[x],alt:s.name,className:"w-full h-full object-contain rounded-lg"}),e.jsx("button",{onClick:()=>h(!1),className:"absolute top-4 right-4 p-2 bg-white/20 backdrop-blur-sm rounded-full hover:bg-white/30 transition-colors",children:e.jsx(ge,{className:"w-6 h-6 text-white"})})]})})})]})},ve=({product:s})=>e.jsx(ue,{to:`/product/${s.id}`,className:"block group",children:e.jsxs(t.div,{className:"bg-white rounded-xl shadow-lg overflow-hidden border border-gray-100",whileHover:{y:-4,shadow:"0 20px 40px rgba(0,0,0,0.1)"},transition:{type:"spring",stiffness:300,damping:30},children:[e.jsxs("div",{className:"relative aspect-square bg-gray-50",children:[e.jsx("img",{src:s.image,alt:s.name,className:"w-full h-full object-cover",loading:"lazy"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h4",{className:"font-semibold text-gray-800 group-hover:text-blue-600 transition-colors line-clamp-2 mb-2",children:s.name}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-lg font-bold text-blue-600",children:["₺",s.price.toFixed(2)]}),e.jsx(T,{rating:s.rating,size:"w-4 h-4"})]})]})]})}),Ne=({product:s,onToggleLike:c,isLiked:d,allProducts:n})=>{const{addToCart:h,buyNow:x}=pe(),{currentUser:l}=be(),[a,N]=i.useState(s),[y,o]=i.useState([]),[u,D]=i.useState(!0),[j,H]=i.useState(1),[w,z]=i.useState(0),[k,I]=i.useState(""),[P,F]=i.useState(!1),[Y,C]=i.useState(!1),[p,q]=i.useState(1);i.useEffect(()=>{N(s)},[s]),i.useEffect(()=>{(async()=>{if(a.id)try{D(!0);const b=A(f,"products",a.id,"reviews"),R=M(b,B("createdAt","desc")),S=(await Z(R)).docs.map(g=>({id:g.id,...g.data(),createdAt:g.data().createdAt?.toDate()||new Date}));if(o(S),l){const g=S.find(m=>m.userId===l.uid);C(!!g)}else C(!1)}catch(b){console.error("Yorumları çekerken hata oluştu:",b)}finally{D(!1)}})()},[a.id,l]);const X=async r=>{if(r.preventDefault(),w===0||!k.trim()){alert("Lütfen puan verin ve bir yorum yazın.");return}F(!0);const b=O(f,"products",a.id),R=A(f,"products",a.id,"reviews");try{await ye(f,async m=>{const $=await m.get(b);if(!$.exists())throw"Ürün bulunamadı!";const E=$.data(),W=E.rating||0,G=E.reviews||0,U=G+1,ee=(W*G+w)/U;m.update(b,{reviews:U,rating:parseFloat(ee.toFixed(2))});const ae=O(R);m.set(ae,{userId:l.uid,userName:l.displayName||l.email,rating:w,comment:k,createdAt:fe()})}),I(""),z(0),C(!0);const v=M(A(f,"products",a.id,"reviews"),B("createdAt","desc")),g=(await Z(v)).docs.map(m=>({id:m.id,...m.data(),createdAt:m.data().createdAt?.toDate()||new Date}));o(g)}catch(v){console.error("Yorum gönderilirken hata oluştu:",v),alert("Yorumunuz gönderilirken bir hata oluştu. Lütfen tekrar deneyin.")}finally{F(!1)}},L=n?n.filter(r=>r.category===a.category&&r.id!==a.id).slice(0,4):[],J=()=>{for(let r=0;r<p;r++)h(a)};return e.jsx("div",{className:"bg-gradient-to-br from-gray-50 to-white min-h-screen",children:e.jsxs("main",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row gap-8 lg:gap-12",children:[e.jsx("div",{className:"lg:w-1/2",children:e.jsx(we,{product:a,isLiked:d,onToggleLike:c})}),e.jsx("div",{className:"lg:w-1/2",children:e.jsxs(t.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},transition:{duration:.6},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-600 text-sm font-medium rounded-full",children:a.category}),e.jsxs("span",{className:"px-3 py-1 bg-purple-100 text-purple-600 text-sm font-medium rounded-full",children:[a.ageGroup," yaş"]})]}),e.jsx("h1",{className:"text-3xl lg:text-4xl font-bold mb-4 text-gray-900 leading-tight",children:a.name}),e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx(T,{rating:a.rating}),e.jsx("span",{className:"text-lg font-semibold text-gray-800",children:a.rating}),e.jsxs("span",{className:"text-gray-500",children:["(",a.reviews," yorum)"]}),e.jsxs("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 text-xs font-bold rounded-full flex items-center gap-1",children:[e.jsx(te,{className:"w-3 h-3"}),"En Çok Satan"]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 p-6 rounded-2xl mb-6 border border-blue-100",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsxs("span",{className:"text-4xl font-extrabold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:["₺",a.price.toFixed(2)]}),a.originalPrice&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-xl text-gray-400 line-through",children:["₺",a.originalPrice.toFixed(2)]}),e.jsxs("span",{className:"px-3 py-1 bg-green-500 text-white text-sm font-bold rounded-full",children:["%",Math.round((a.originalPrice-a.price)/a.originalPrice*100)," İndirim"]})]})]}),e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Adet:"}),e.jsxs("div",{className:"flex items-center border border-gray-200 rounded-lg",children:[e.jsx("button",{onClick:()=>q(Math.max(1,p-1)),className:"px-3 py-2 hover:bg-gray-50 transition-colors",children:"-"}),e.jsx("span",{className:"px-4 py-2 font-semibold",children:p}),e.jsx("button",{onClick:()=>q(p+1),className:"px-3 py-2 hover:bg-gray-50 transition-colors",children:"+"})]}),e.jsxs("span",{className:"text-sm text-gray-500",children:["Toplam: ₺",(a.price*p).toFixed(2)]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs(t.button,{onClick:J,whileHover:{scale:1.02},whileTap:{scale:.98},className:"flex-1 py-4 px-6 bg-gradient-to-r from-blue-600 to-purple-600 text-white font-bold rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 flex items-center justify-center gap-2",children:[e.jsx(re,{className:"w-5 h-5"}),"Sepete Ekle (",p," Adet)"]}),e.jsxs(t.button,{onClick:()=>x(a),whileHover:{scale:1.02},whileTap:{scale:.98},className:"flex-1 py-4 px-6 bg-white border-2 border-blue-600 text-blue-600 font-bold rounded-xl hover:bg-blue-50 transition-all duration-300 flex items-center justify-center gap-2",children:[e.jsx(le,{className:"w-5 h-5"}),"Hemen Satın Al"]})]})]}),e.jsx("p",{className:"text-gray-700 text-lg leading-relaxed mb-8",children:a.description}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(Q,{title:"Ürün Özellikleri",isOpen:j===1,onClick:()=>H(j===1?0:1),children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-600",children:"Kategori:"}),e.jsx("span",{className:"ml-2 text-gray-800",children:a.category})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-600",children:"Yaş Grubu:"}),e.jsx("span",{className:"ml-2 text-gray-800",children:a.ageGroup})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"font-semibold text-gray-600",children:"Etiketler:"}),e.jsx("span",{className:"ml-2 text-gray-800",children:a.tags?.join(", ")})]})]})}),e.jsx(Q,{title:"Kargo ve Teslimat",isOpen:j===2,onClick:()=>H(j===2?0:2),children:e.jsxs("div",{className:"space-y-3 text-sm text-gray-700",children:[e.jsx("p",{children:"📦 Saat 15:00'e kadar verilen siparişler aynı gün kargoya verilir."}),e.jsx("p",{children:"🚚 Tahmini teslimat süresi 1-3 iş günüdür."}),e.jsx("p",{children:"💳 Kapıda ödeme ve kredi kartı ile ödeme seçenekleri mevcuttur."})]})})]})]})})]}),e.jsxs(t.div,{className:"mt-16 pt-8 border-t",initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{delay:.4},children:[e.jsxs("h3",{className:"text-3xl font-bold mb-8 text-center",children:["Değerlendirmeler (",y.length,")"]}),l&&!Y&&e.jsxs(t.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-gradient-to-r from-blue-50 to-purple-50 p-8 rounded-2xl shadow-lg border border-blue-100 mb-8",children:[e.jsx("h4",{className:"font-bold text-xl mb-6 text-center",children:"Değerlendirme Yap"}),e.jsxs("form",{onSubmit:X,className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Puanınız"}),e.jsx(je,{rating:w,setRating:z})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"comment",className:"block text-sm font-medium text-gray-700 mb-2",children:"Yorumunuz"}),e.jsx("textarea",{id:"comment",rows:"4",className:"w-full p-4 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",value:k,onChange:r=>I(r.target.value),placeholder:"Ürün hakkındaki düşüncelerinizi paylaşın..."})]}),e.jsxs(t.button,{type:"submit",disabled:P,whileHover:{scale:1.02},whileTap:{scale:.98},className:"w-full flex items-center justify-center px-8 py-4 bg-gradient-to-r from-blue-600 to-purple-600 text-white font-bold rounded-xl hover:shadow-lg transition-all disabled:opacity-50",children:[e.jsx(ie,{className:"w-5 h-5 mr-2"}),P?"Gönderiliyor...":"Yorumu Gönder"]})]})]}),l&&Y&&e.jsx("div",{className:"bg-green-50 border border-green-200 p-6 rounded-xl text-center text-green-800 mb-8",children:e.jsx("p",{className:"font-semibold",children:"Bu ürün için zaten bir değerlendirme yaptınız. Teşekkür ederiz!"})}),u?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Yorumlar yükleniyor..."})]}):y.length===0?e.jsxs("div",{className:"bg-gray-50 p-12 rounded-2xl text-center",children:[e.jsx("p",{className:"text-gray-600 text-lg",children:"Bu ürün için henüz hiç yorum yapılmamış."}),e.jsx("p",{className:"text-gray-500",children:"İlk yorumu siz yapın!"})]}):e.jsx("div",{className:"grid gap-6",children:y.map(r=>e.jsxs(t.div,{className:"bg-white p-6 rounded-2xl shadow-lg border border-gray-100",whileHover:{y:-2},transition:{type:"spring",stiffness:300,damping:30},children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center text-white font-bold",children:r.userName.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-gray-800",children:r.userName}),e.jsx("p",{className:"text-sm text-gray-500",children:new Date(r.createdAt).toLocaleDateString("tr-TR")})]})]}),e.jsx(T,{rating:r.rating})]}),e.jsx("p",{className:"text-gray-700 leading-relaxed",children:r.comment})]},r.id))})]}),L.length>0&&e.jsxs(t.div,{className:"mt-16 pt-8 border-t",initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},children:[e.jsx("h3",{className:"text-3xl font-bold mb-8 text-center",children:"İlgini Çekebilecek Diğer Ürünler"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-6",children:L.map(r=>e.jsx(ve,{product:r},r.id))})]})]})})},Ae=i.memo(Ne);export{Ae as default};
