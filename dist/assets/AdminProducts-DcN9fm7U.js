import{j as e,m as y,ag as q,P as z,S as T,O as Y,A as K,q as R,az as I,E as M,as as O,ae as U,X as B,at as _,aA as $,aB as H}from"./ui-CStX2XNU.js";import{r as x}from"./vendor-D5Lolgu6.js";import{h as L,q as V,m as W,j as J,k as X,n as G,D as Q,E as Z}from"./firebase-DdLFvxrj.js";import{d as N,b as ee}from"./index-0L1wPOp8.js";const ae=({images:r,setImages:p,isUploading:u,setIsUploading:m})=>{const[a,i]=x.useState(!1),c=async s=>{if(!s||s.length===0)return;const o=Array.from(s).filter(d=>d.type.startsWith("image/"));if(o.length===0){alert("Lütfen sadece resim dosyaları seçin.");return}m(!0);try{const d=await ee(o,"products");p(b=>[...b,...d])}catch(d){console.error("File upload error:",d),alert("Fotoğraflar yüklenirken hata oluştu.")}finally{m(!1)}},g=s=>{s.preventDefault(),s.stopPropagation(),s.type==="dragenter"||s.type==="dragover"?i(!0):s.type==="dragleave"&&i(!1)},f=s=>{s.preventDefault(),s.stopPropagation(),i(!1),c(s.dataTransfer.files)},h=s=>{p(o=>o.filter((d,b)=>b!==s))};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:`relative border-2 border-dashed rounded-lg p-6 transition-all duration-200 ${a?"border-blue-400 bg-blue-50":"border-gray-300 hover:border-gray-400 bg-gray-50"}`,onDragEnter:g,onDragLeave:g,onDragOver:g,onDrop:f,children:[e.jsx("input",{type:"file",multiple:!0,accept:"image/*",onChange:s=>c(s.target.files),className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",disabled:u}),e.jsx("div",{className:"text-center",children:u?e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx($,{className:"w-8 h-8 text-blue-500 animate-spin"}),e.jsx("p",{className:"text-sm text-blue-600",children:"Fotoğraflar yükleniyor..."})]}):e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(H,{className:"w-8 h-8 text-gray-400"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Fotoğrafları sürükleyin veya ",e.jsx("span",{className:"text-blue-600 font-medium",children:"tıklayın"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"PNG, JPG, WEBP - Maksimum 10MB"})]})})]}),r.length>0&&e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:r.map((s,o)=>e.jsxs(y.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},className:"relative group",children:[e.jsx("img",{src:s,alt:`Upload ${o+1}`,className:"w-full h-24 object-cover rounded-lg border border-gray-200",onError:d=>{d.target.src="https://via.placeholder.com/100x100?text=Error"}}),e.jsx("button",{onClick:()=>h(o),className:"absolute -top-2 -right-2 w-6 h-6 bg-red-500 text-white rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-600",children:e.jsx(B,{className:"w-3 h-3"})}),o===0&&e.jsx("div",{className:"absolute bottom-1 left-1 px-2 py-1 bg-blue-500 text-white text-xs rounded",children:"Ana"})]},o))})]})},te=({product:r,onSave:p,onCancel:u,isEditing:m=!1})=>{const[a,i]=x.useState({name:"",category:"",ageGroup:"",price:"",originalPrice:"",description:"",tags:"",shopierLink:"",badge:"",rating:4.5,reviews:0,...r||{},tags:r?.tags?Array.isArray(r.tags)?r.tags.join(", "):r.tags:""}),[c,g]=x.useState(r?.images||[r?.image].filter(Boolean)||[]),[f,h]=x.useState(!1),[s,o]=x.useState(!1),d=["deney","eğitici","oyuncak","dekoratif"],b=["3-6","7-12","13+"],j=["","Yeni","Çok Satan","Trend","Popüler","Özel Seri"],w=async t=>{if(t.preventDefault(),c.length===0){alert("En az bir fotoğraf yüklemelisiniz.");return}o(!0);try{const v={...a,price:parseFloat(a.price),originalPrice:a.originalPrice?parseFloat(a.originalPrice):null,rating:parseFloat(a.rating),reviews:parseInt(a.reviews),tags:typeof a.tags=="string"&&a.tags.trim()?a.tags.split(",").map(k=>k.trim()).filter(Boolean):[],images:c,image:c[0],updatedAt:new Date};m||(v.createdAt=new Date),await p(v)}catch(v){console.error("Product save error:",v),alert("Ürün kaydedilirken hata oluştu!")}finally{o(!1)}};return e.jsx(y.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs(y.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"bg-white rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:m?"Ürün Düzenle":"Yeni Ürün Ekle"}),e.jsx("button",{onClick:u,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(B,{className:"w-5 h-5"})})]})}),e.jsxs("form",{onSubmit:w,className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ürün Fotoğrafları *"}),e.jsx(ae,{images:c,setImages:g,isUploading:f,setIsUploading:h})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ürün Adı *"}),e.jsx("input",{type:"text",required:!0,value:a.name,onChange:t=>i({...a,name:t.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Ürün adını giriniz"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Kategori *"}),e.jsxs("select",{required:!0,value:a.category,onChange:t=>i({...a,category:t.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Kategori Seçin"}),d.map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Yaş Grubu *"}),e.jsxs("select",{required:!0,value:a.ageGroup,onChange:t=>i({...a,ageGroup:t.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Yaş Grubu Seçin"}),b.map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fiyat (₺) *"}),e.jsx("input",{type:"number",step:"0.01",required:!0,value:a.price,onChange:t=>i({...a,price:t.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"199.99"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Eski Fiyat (₺)"}),e.jsx("input",{type:"number",step:"0.01",value:a.originalPrice||"",onChange:t=>i({...a,originalPrice:t.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"299.99"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Badge"}),e.jsx("select",{value:a.badge||"",onChange:t=>i({...a,badge:t.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:j.map(t=>e.jsx("option",{value:t,children:t||"Badge Yok"},t))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Açıklama *"}),e.jsx("textarea",{required:!0,rows:3,value:a.description,onChange:t=>i({...a,description:t.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Ürün açıklamasını giriniz"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Etiketler (virgülle ayırın)"}),e.jsx("input",{type:"text",value:a.tags,onChange:t=>i({...a,tags:t.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"fizik, kimya, deney"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rating (1-5)"}),e.jsx("input",{type:"number",min:"1",max:"5",step:"0.1",value:a.rating,onChange:t=>i({...a,rating:t.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Yorum Sayısı"}),e.jsx("input",{type:"number",min:"0",value:a.reviews,onChange:t=>i({...a,reviews:t.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Shopier Link"}),e.jsx("input",{type:"text",value:a.shopierLink||"",onChange:t=>i({...a,shopierLink:t.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"#SHOPIER_LINK_HERE"})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-4 pt-6 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:u,className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"İptal"}),e.jsx("button",{type:"submit",disabled:s||f,className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:s?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}),"Kaydediliyor..."]}):e.jsxs(e.Fragment,{children:[e.jsx(_,{className:"w-4 h-4"}),m?"Güncelle":"Kaydet"]})})]})]})]})})},re=({product:r,onEdit:p,onDelete:u,onView:m})=>{const[a,i]=x.useState(!1),c=r.images||[r.image].filter(Boolean);return e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:c[0]||r.image,alt:r.name,className:"w-12 h-12 object-cover rounded-lg mr-4",onError:g=>{g.target.src="https://via.placeholder.com/48x48?text=No+Image"}}),c.length>1&&e.jsx("div",{className:"absolute -top-1 -right-3 w-5 h-5 bg-blue-500 text-white text-xs rounded-full flex items-center justify-center",children:c.length})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:r.name}),e.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",r.id]})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full",children:r.category})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:r.ageGroup}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.jsxs("div",{className:"flex items-center",children:[r.originalPrice&&e.jsxs("span",{className:"text-gray-400 line-through mr-2",children:["₺",r.originalPrice.toFixed(2)]}),e.jsxs("span",{className:"font-semibold",children:["₺",r.price.toFixed(2)]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(R,{className:"w-4 h-4 text-yellow-400 fill-current mr-1"}),r.rating," (",r.reviews,")"]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.badge&&e.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-green-100 text-green-800 rounded-full",children:r.badge})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>i(!a),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(I,{className:"w-4 h-4"})}),a&&e.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 z-10",children:[e.jsxs("button",{onClick:()=>{m(r),i(!1)},className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),"Görüntüle"]}),e.jsxs("button",{onClick:()=>{p(r),i(!1)},className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[e.jsx(O,{className:"w-4 h-4 mr-2"}),"Düzenle"]}),e.jsxs("button",{onClick:()=>{u(r),i(!1)},className:"flex items-center w-full px-4 py-2 text-sm text-red-600 hover:bg-red-50",children:[e.jsx(U,{className:"w-4 h-4 mr-2"}),"Sil"]})]})]})})]})};function oe(){const[r,p]=x.useState([]),[u,m]=x.useState(!0),[a,i]=x.useState(""),[c,g]=x.useState(""),[f,h]=x.useState(!1),[s,o]=x.useState(null),[d,b]=x.useState({total:0,byCategory:{}}),j=async()=>{try{m(!0);const l=L(N,"products"),n=V(l,W("name","asc")),C=await J(n),P=[],D={};C.forEach(E=>{const F={id:E.id,...E.data()};P.push(F);const A=F.category;D[A]=(D[A]||0)+1}),p(P),b({total:P.length,byCategory:D})}catch(l){console.error("Error fetching products:",l),alert("Ürünler yüklenirken hata oluştu!")}finally{m(!1)}},w=async l=>{try{await X(L(N,"products"),l),h(!1),j(),alert("Ürün başarıyla eklendi!")}catch(n){throw console.error("Error adding product:",n),n}},t=async l=>{try{const n=G(N,"products",s.id);await Q(n,l),o(null),h(!1),j(),alert("Ürün başarıyla güncellendi!")}catch(n){throw console.error("Error updating product:",n),n}},v=async l=>{if(window.confirm(`"${l.name}" ürününü silmek istediğinizden emin misiniz?`))try{await Z(G(N,"products",l.id)),j(),alert("Ürün başarıyla silindi!")}catch(n){console.error("Error deleting product:",n),alert("Ürün silinirken hata oluştu!")}},k=l=>{window.open(`/product/${l.id}`,"_blank")},S=r.filter(l=>{const n=l.name.toLowerCase().includes(a.toLowerCase())||l.description.toLowerCase().includes(a.toLowerCase()),C=!c||l.category===c;return n&&C});return x.useEffect(()=>{j()},[]),e.jsx("div",{className:"min-h-screen bg-gray-50",style:{paddingTop:"80px"},children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Ürün Yönetimi"}),e.jsxs("p",{className:"text-gray-600 mt-2",children:["Toplam ",d.total," ürün • ",S.length," ürün görüntüleniyor"]})]}),e.jsxs(y.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>h(!0),className:"bg-blue-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-blue-700 transition-colors flex items-center gap-2",children:[e.jsx(q,{className:"w-5 h-5"}),"Yeni Ürün Ekle"]})]}),e.jsxs(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsx("div",{className:"bg-white p-6 rounded-2xl shadow-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Toplam Ürün"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:d.total})]}),e.jsx("div",{className:"p-3 rounded-xl bg-blue-500",children:e.jsx(z,{className:"w-6 h-6 text-white"})})]})}),Object.entries(d.byCategory).map(([l,n])=>e.jsx("div",{className:"bg-white p-6 rounded-2xl shadow-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 capitalize",children:l}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:n})]}),e.jsx("div",{className:"p-3 rounded-xl bg-green-500",children:e.jsx(T,{className:"w-6 h-6 text-white"})})]})},l))]}),e.jsx(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white rounded-2xl shadow-lg p-6 mb-8",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(Y,{className:"w-5 h-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Ürün ara...",value:a,onChange:l=>i(l.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),e.jsx("div",{className:"md:w-48",children:e.jsxs("select",{value:c,onChange:l=>g(l.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Tüm Kategoriler"}),e.jsx("option",{value:"deney",children:"Deney"}),e.jsx("option",{value:"eğitici",children:"Eğitici"}),e.jsx("option",{value:"oyuncak",children:"Oyuncak"}),e.jsx("option",{value:"dekoratif",children:"Dekoratif"})]})})]})}),e.jsx(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:u?e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-4 border-b-4 border-blue-600"})}):S.length===0?e.jsxs("div",{className:"text-center p-12",children:[e.jsx(z,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Ürün Bulunamadı"}),e.jsx("p",{className:"text-gray-600",children:"Arama kriterlerinize uygun ürün bulunamadı."})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ürün"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Kategori"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Yaş Grubu"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fiyat"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rating"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Badge"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"İşlemler"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:S.map(l=>e.jsx(re,{product:l,onEdit:n=>{o(n),h(!0)},onDelete:v,onView:k},l.id))})]})})}),e.jsx(K,{children:f&&e.jsx(te,{product:s,onSave:s?t:w,onCancel:()=>{h(!1),o(null)},isEditing:!!s})})]})})}export{oe as default};
