import{j as e,d as re,a3 as H,P as U,c as K,a as te,A as B,m as g,X as le,as as ie,at as de,am as ne,E as oe,ag as ce,ae as ue}from"./ui-CStX2XNU.js";import{r as t}from"./vendor-D5Lolgu6.js";import{a as xe,d as m}from"./index-0L1wPOp8.js";import{y as me,n as f,q as P,h as j,m as k,j as A,A as ge,u as pe,v as L,B as he,D as ye}from"./firebase-DdLFvxrj.js";function we(){const{currentUser:r}=xe(),[C,O]=t.useState("profile"),[S,d]=t.useState(!1),[N,D]=t.useState(null),[i,p]=t.useState({displayName:r?.displayName||"",email:r?.email||"",phone:"",birthDate:"",newsletter:!0}),[c,z]=t.useState(!1),[u,y]=t.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[h,R]=t.useState(!1),[E,Y]=t.useState([]),[I,v]=t.useState(!1),[n,o]=t.useState({title:"",name:"",address:"",city:"",district:"",postalCode:"",phone:"",isDefault:!1}),[T,Q]=t.useState([]),[be,q]=t.useState([]),G=[{id:"profile",label:"Profil Bilgileri",icon:re},{id:"addresses",label:"Adreslerim",icon:H},{id:"orders",label:"Siparişlerim",icon:U},{id:"favorites",label:"Favorilerim",icon:K},{id:"settings",label:"Hesap Ayarları",icon:te}];t.useEffect(()=>{w(),M(),$()},[r]);const w=async()=>{if(r){d(!0);try{const s=await me(f(m,"users",r.uid));if(s.exists()){const b=s.data();p(ae=>({...ae,...b,email:r.email}))}const a=P(j(m,"users",r.uid,"addresses"),k("createdAt","desc")),x=await A(a);Y(x.docs.map(b=>({id:b.id,...b.data()})))}catch(s){console.error("Error loading user data:",s),l("Veriler yüklenirken hata oluştu","error")}finally{d(!1)}}},M=async()=>{if(r)try{const s=P(j(m,"orders"),ge("userId","==",r.uid),k("createdAt","desc")),a=await A(s);Q(a.docs.map(x=>({id:x.id,...x.data()})))}catch(s){console.error("Error loading orders:",s)}},$=async()=>{if(r)try{const s=P(j(m,"users",r.uid,"favorites"),k("createdAt","desc")),a=await A(s);q(a.docs.map(x=>({id:x.id,...x.data()})))}catch(s){console.error("Error loading favorites:",s)}},l=(s,a="success")=>{D({message:s,type:a}),setTimeout(()=>D(null),3e3)},V=async()=>{if(r){d(!0);try{await pe(r,{displayName:i.displayName}),await L(f(m,"users",r.uid),{...i,updatedAt:new Date},{merge:!0}),z(!1),l("Profil bilgileri güncellendi")}catch(s){console.error("Error updating profile:",s),l("Profil güncellenirken hata oluştu","error")}finally{d(!1)}}},X=async()=>{if(r){if(u.newPassword!==u.confirmPassword){l("Şifreler eşleşmiyor","error");return}if(u.newPassword.length<6){l("Şifre en az 6 karakter olmalı","error");return}d(!0);try{await he(r,u.newPassword),y({currentPassword:"",newPassword:"",confirmPassword:""}),l("Şifre başarıyla güncellendi")}catch(s){console.error("Error updating password:",s),l("Şifre güncellenirken hata oluştu","error")}finally{d(!1)}}},J=async()=>{if(r){d(!0);try{const s=j(m,"users",r.uid,"addresses");await L(f(s),{...n,createdAt:new Date}),o({title:"",name:"",address:"",city:"",district:"",postalCode:"",phone:"",isDefault:!1}),v(!1),w(),l("Adres başarıyla eklendi")}catch(s){console.error("Error adding address:",s),l("Adres eklenirken hata oluştu","error")}finally{d(!1)}}},W=async s=>{if(r)try{await ye(f(m,"users",r.uid,"addresses",s),{deleted:!0}),w(),l("Adres silindi")}catch(a){console.error("Error deleting address:",a),l("Adres silinirken hata oluştu","error")}},F=()=>e.jsxs(g.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-purple-600 p-6 rounded-2xl text-white",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-20 h-20 bg-white/20 rounded-full flex items-center justify-center text-3xl font-bold",children:i.displayName?.charAt(0)?.toUpperCase()||"U"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:i.displayName||"Kullanıcı"}),e.jsx("p",{className:"text-blue-100",children:i.email}),e.jsxs("p",{className:"text-sm text-blue-200",children:["Üyelik: ",new Date(r?.metadata?.creationTime).toLocaleDateString("tr-TR")]})]})]})}),e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Kişisel Bilgiler"}),e.jsxs("button",{onClick:()=>z(!c),className:"flex items-center space-x-2 px-4 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-colors",children:[c?e.jsx(le,{size:16}):e.jsx(ie,{size:16}),e.jsx("span",{children:c?"İptal":"Düzenle"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ad Soyad"}),e.jsx("input",{type:"text",value:i.displayName,onChange:s=>p(a=>({...a,displayName:s.target.value})),disabled:!c,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"E-posta"}),e.jsx("input",{type:"email",value:i.email,disabled:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg bg-gray-50 text-gray-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Telefon"}),e.jsx("input",{type:"tel",value:i.phone,onChange:s=>p(a=>({...a,phone:s.target.value})),disabled:!c,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Doğum Tarihi"}),e.jsx("input",{type:"date",value:i.birthDate,onChange:s=>p(a=>({...a,birthDate:s.target.value})),disabled:!c,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-50"})]})]}),c&&e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsxs("button",{onClick:V,disabled:S,className:"flex items-center space-x-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:[e.jsx(de,{size:16}),e.jsx("span",{children:"Kaydet"})]})})]})]}),Z=()=>e.jsxs(g.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Kayıtlı Adreslerim"}),e.jsxs("button",{onClick:()=>v(!0),className:"flex items-center space-x-2 px-4 py-2 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors",children:[e.jsx(ce,{size:16}),e.jsx("span",{children:"Yeni Adres"})]})]}),e.jsx(B,{children:I&&e.jsxs(g.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"bg-white p-6 rounded-2xl shadow-lg",children:[e.jsx("h4",{className:"text-lg font-semibold mb-4",children:"Yeni Adres Ekle"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("input",{type:"text",placeholder:"Adres başlığı (Ev, İş vb.)",value:n.title,onChange:s=>o(a=>({...a,title:s.target.value})),className:"px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),e.jsx("input",{type:"text",placeholder:"Ad Soyad",value:n.name,onChange:s=>o(a=>({...a,name:s.target.value})),className:"px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),e.jsx("input",{type:"text",placeholder:"Şehir",value:n.city,onChange:s=>o(a=>({...a,city:s.target.value})),className:"px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),e.jsx("input",{type:"text",placeholder:"İlçe",value:n.district,onChange:s=>o(a=>({...a,district:s.target.value})),className:"px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),e.jsx("input",{type:"text",placeholder:"Posta Kodu",value:n.postalCode,onChange:s=>o(a=>({...a,postalCode:s.target.value})),className:"px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),e.jsx("input",{type:"tel",placeholder:"Telefon",value:n.phone,onChange:s=>o(a=>({...a,phone:s.target.value})),className:"px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsx("textarea",{placeholder:"Detaylı adres",value:n.address,onChange:s=>o(a=>({...a,address:s.target.value})),rows:3,className:"w-full mt-4 px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-4",children:[e.jsx("button",{onClick:()=>v(!1),className:"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:"İptal"}),e.jsx("button",{onClick:J,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Kaydet"})]})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:E.filter(s=>!s.deleted).map(s=>e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-lg",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx("h4",{className:"font-semibold text-gray-800",children:s.title}),e.jsx("button",{onClick:()=>W(s.id),className:"text-red-500 hover:bg-red-50 p-1 rounded",children:e.jsx(ue,{size:16})})]}),e.jsx("p",{className:"text-gray-600 mb-2",children:s.name}),e.jsx("p",{className:"text-sm text-gray-500 mb-2",children:s.address}),e.jsxs("p",{className:"text-sm text-gray-500",children:[s.district,", ",s.city," ",s.postalCode]}),e.jsx("p",{className:"text-sm text-gray-500",children:s.phone})]},s.id))}),E.filter(s=>!s.deleted).length===0&&e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(H,{size:48,className:"mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"Henüz kayıtlı adresiniz bulunmamaktadır."})]})]}),_=()=>e.jsxs(g.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Sipariş Geçmişim"}),T.length>0?e.jsx("div",{className:"space-y-4",children:T.map(s=>e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-lg",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold text-gray-800",children:["Sipariş #",s.id?.slice(-8)]}),e.jsx("p",{className:"text-sm text-gray-500",children:s.createdAt?.toDate?.()?.toLocaleDateString("tr-TR")})]}),e.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm",children:s.status||"Hazırlanıyor"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("p",{className:"text-lg font-semibold text-gray-800",children:["₺",s.total]}),e.jsxs("p",{className:"text-sm text-gray-500",children:[s.items?.length||0," ürün"]})]})]},s.id))}):e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(U,{size:48,className:"mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"Henüz siparişiniz bulunmamaktadır."})]})]}),ee=()=>e.jsxs(g.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-lg",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-6",children:"Şifre Değiştir"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:h?"text":"password",placeholder:"Mevcut şifre",value:u.currentPassword,onChange:s=>y(a=>({...a,currentPassword:s.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 pr-12"}),e.jsx("button",{onClick:()=>R(!h),className:"absolute right-3 top-3 text-gray-400 hover:text-gray-600",children:h?e.jsx(ne,{size:20}):e.jsx(oe,{size:20})})]}),e.jsx("input",{type:h?"text":"password",placeholder:"Yeni şifre",value:u.newPassword,onChange:s=>y(a=>({...a,newPassword:s.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),e.jsx("input",{type:h?"text":"password",placeholder:"Yeni şifre tekrar",value:u.confirmPassword,onChange:s=>y(a=>({...a,confirmPassword:s.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),e.jsx("button",{onClick:X,disabled:S,className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:"Şifreyi Güncelle"})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-lg",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-6",children:"Bildirim Ayarları"}),e.jsx("div",{className:"space-y-4",children:e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:i.newsletter,onChange:s=>p(a=>({...a,newsletter:s.target.checked})),className:"w-5 h-5 text-blue-600 rounded focus:ring-blue-500"}),e.jsx("span",{className:"text-gray-700",children:"E-posta bildirimleri al"})]})})]})]}),se=()=>{switch(C){case"profile":return F();case"addresses":return Z();case"orders":return _();case"favorites":return e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(K,{size:48,className:"mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"Favori ürünleriniz burada görünecektir."})]});case"settings":return ee();default:return F()}};return r?e.jsxs("div",{className:"min-h-screen bg-gray-50",style:{paddingTop:"80px"},children:[e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Hesabım"}),e.jsx("p",{className:"text-gray-600",children:"Hesap bilgilerinizi yönetin"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsx("div",{className:"bg-white rounded-2xl shadow-lg p-4",children:e.jsx("nav",{className:"space-y-2",children:G.map(s=>e.jsxs("button",{onClick:()=>O(s.id),className:`w-full flex items-center space-x-3 px-4 py-3 rounded-xl transition-all duration-200 ${C===s.id?"bg-blue-100 text-blue-700 font-medium":"text-gray-600 hover:bg-gray-100"}`,children:[e.jsx(s.icon,{size:20}),e.jsx("span",{children:s.label})]},s.id))})})}),e.jsx("div",{className:"lg:col-span-3",children:se()})]})]}),e.jsx(B,{children:N&&e.jsx(g.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},exit:{opacity:0,y:50},className:`fixed bottom-4 right-4 px-6 py-3 rounded-lg shadow-lg text-white z-50 ${N.type==="error"?"bg-red-500":"bg-green-500"}`,children:N.message})})]}):e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsx("div",{className:"text-center",children:e.jsx("p",{className:"text-gray-600",children:"Profil sayfasına erişmek için giriş yapınız."})})})}export{we as default};
